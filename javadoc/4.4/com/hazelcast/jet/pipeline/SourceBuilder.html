<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (15) on Mon Feb 01 17:53:40 CET 2021 -->
<title>SourceBuilder (hazelcast-jet-distribution 4.4 API)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2021-02-01">
<meta name="description" content="declaration: package: com.hazelcast.jet.pipeline, class: SourceBuilder">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-3.5.1.min.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var data = {"i0":9,"i1":9,"i2":9};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],8:["t4","Concrete Methods"]};
var altColor = "alt-color";
var rowColor = "row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar.top">
<div class="skip-nav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar.top.firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/SourceBuilder.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip.navbar.top">
<!--   -->
</span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">com.hazelcast.jet.pipeline</a></div>
<h1 title="Class SourceBuilder" class="title">Class SourceBuilder&lt;C&gt;</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">com.hazelcast.jet.pipeline.SourceBuilder&lt;C&gt;</div>
</div>
<section class="description">
<dl class="notes">
<dt>Type Parameters:</dt>
<dd><code>C</code> - type of the context object</dd>
</dl>
<hr>
<pre>public final class <span class="type-name-label">SourceBuilder&lt;C&gt;</span>
extends <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></pre>
<div class="block">Top-level class for Jet custom source builders. It is associated
 with a <em>context object</em> that holds any necessary state and
 resources you need to make your source work.
 <p>
 For further details refer to the factory methods:
 <ul>
     <li><a href="#batch(java.lang.String,com.hazelcast.function.FunctionEx)"><code>batch(String, FunctionEx)</code></a>
     <li><a href="#timestampedStream(java.lang.String,com.hazelcast.function.FunctionEx)"><code>timestampedStream(String, FunctionEx)</code></a>
     <li><a href="#stream(java.lang.String,com.hazelcast.function.FunctionEx)"><code>stream(String, FunctionEx)</code></a>
 </ul></div>
<dl class="notes">
<dt>Since:</dt>
<dd>3.0</dd>
</dl>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<li>
<section class="nested-class-summary" id="nested.class.summary">
<h2>Nested Class Summary</h2>
<div class="member-summary">
<table class="summary-table">
<caption><span>Nested Classes</span></caption>
<thead>
<tr>
<th class="col-first" scope="col">Modifier and Type</th>
<th class="col-second" scope="col">Class</th>
<th class="col-last" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="alt-color">
<td class="col-first"><code>class&nbsp;</code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="SourceBuilder.Batch.html" title="class in com.hazelcast.jet.pipeline">SourceBuilder.Batch</a>&lt;<a href="SourceBuilder.Batch.html" title="type parameter in SourceBuilder.Batch">T</a>&gt;</span></code></th>
<td class="col-last">
<div class="block">See <a href="#batch(java.lang.String,com.hazelcast.function.FunctionEx)"><code>batch(String, FunctionEx)</code></a>.</div>
</td>
</tr>
<tr class="row-color">
<td class="col-first"><code>class&nbsp;</code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="SourceBuilder.FaultTolerant.html" title="class in com.hazelcast.jet.pipeline">SourceBuilder.FaultTolerant</a>&lt;<a href="SourceBuilder.FaultTolerant.html" title="type parameter in SourceBuilder.FaultTolerant">B</a>,&#8203;<a href="SourceBuilder.FaultTolerant.html" title="type parameter in SourceBuilder.FaultTolerant">S</a>&gt;</span></code></th>
<td class="col-last">
<div class="block">Represents a step in building a custom source where you add a <a href="SourceBuilder.FaultTolerant.html#restoreSnapshotFn(com.hazelcast.function.BiConsumerEx)"><code>SourceBuilder.FaultTolerant.restoreSnapshotFn(com.hazelcast.function.BiConsumerEx&lt;? super C, ? super java.util.List&lt;S&gt;&gt;)</code></a> after adding a <a href="http://jet.hazelcast.org/hazelcast-jet/apidocs/com/hazelcast/jet/pipeline/SourceBuilder.Base.html#createSnapshotFn(com.hazelcast.function.FunctionEx)" title="class or interface in com.hazelcast.jet.pipeline" class="external-link"><code>createSnapshotFn</code></a>.</div>
</td>
</tr>
<tr class="alt-color">
<td class="col-first"><code>static interface&nbsp;</code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="SourceBuilder.SourceBuffer.html" title="interface in com.hazelcast.jet.pipeline">SourceBuilder.SourceBuffer</a>&lt;<a href="SourceBuilder.SourceBuffer.html" title="type parameter in SourceBuilder.SourceBuffer">T</a>&gt;</span></code></th>
<td class="col-last">
<div class="block">The buffer object that the <code>fillBufferFn</code> gets on each call.</div>
</td>
</tr>
<tr class="row-color">
<td class="col-first"><code>class&nbsp;</code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="SourceBuilder.Stream.html" title="class in com.hazelcast.jet.pipeline">SourceBuilder.Stream</a>&lt;<a href="SourceBuilder.Stream.html" title="type parameter in SourceBuilder.Stream">T</a>&gt;</span></code></th>
<td class="col-last">
<div class="block">See <a href="#stream(java.lang.String,com.hazelcast.function.FunctionEx)"><code>stream(String, FunctionEx)</code></a>.</div>
</td>
</tr>
<tr class="alt-color">
<td class="col-first"><code>static interface&nbsp;</code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="SourceBuilder.TimestampedSourceBuffer.html" title="interface in com.hazelcast.jet.pipeline">SourceBuilder.TimestampedSourceBuffer</a>&lt;<a href="SourceBuilder.TimestampedSourceBuffer.html" title="type parameter in SourceBuilder.TimestampedSourceBuffer">T</a>&gt;</span></code></th>
<td class="col-last">
<div class="block">The buffer object that the <code>fillBufferFn</code> gets on each call.</div>
</td>
</tr>
<tr class="row-color">
<td class="col-first"><code>class&nbsp;</code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="SourceBuilder.TimestampedStream.html" title="class in com.hazelcast.jet.pipeline">SourceBuilder.TimestampedStream</a>&lt;<a href="SourceBuilder.TimestampedStream.html" title="type parameter in SourceBuilder.TimestampedStream">T</a>&gt;</span></code></th>
<td class="col-last">
<div class="block">See <a href="#timestampedStream(java.lang.String,com.hazelcast.function.FunctionEx)"><code>timestampedStream(String, FunctionEx)</code></a>.</div>
</td>
</tr>
</tbody>
</table>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method.summary">
<h2>Method Summary</h2>
<div class="member-summary" id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" id="t0" class="active-table-tab">All Methods</button><button role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t1" class="table-tab" onclick="show(1);">Static Methods</button><button role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t4" class="table-tab" onclick="show(8);">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<table class="summary-table" aria-labelledby="t0">
<thead>
<tr>
<th class="col-first" scope="col">Modifier and Type</th>
<th class="col-second" scope="col">Method</th>
<th class="col-last" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="alt-color" id="i0">
<td class="col-first"><code>static &lt;C&gt;&nbsp;<a href="SourceBuilder.Batch.html" title="class in com.hazelcast.jet.pipeline">SourceBuilder.Batch</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="#batch(java.lang.String,com.hazelcast.function.FunctionEx)">batch</a></span>&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;name,
<a href="../../function/FunctionEx.html" title="interface in com.hazelcast.function">FunctionEx</a>&lt;? super <a href="../core/Processor.Context.html" title="interface in com.hazelcast.jet.core">Processor.Context</a>,&#8203;? extends C&gt;&nbsp;createFn)</code></th>
<td class="col-last">
<div class="block">Returns a fluent-API builder with which you can create a <a href="BatchSource.html" title="interface in com.hazelcast.jet.pipeline">batch source</a> for a Jet pipeline.</div>
</td>
</tr>
<tr class="row-color" id="i1">
<td class="col-first"><code>static &lt;C&gt;&nbsp;<a href="SourceBuilder.Stream.html" title="class in com.hazelcast.jet.pipeline">SourceBuilder.Stream</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="#stream(java.lang.String,com.hazelcast.function.FunctionEx)">stream</a></span>&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;name,
<a href="../../function/FunctionEx.html" title="interface in com.hazelcast.function">FunctionEx</a>&lt;? super <a href="../core/Processor.Context.html" title="interface in com.hazelcast.jet.core">Processor.Context</a>,&#8203;? extends C&gt;&nbsp;createFn)</code></th>
<td class="col-last">
<div class="block">Returns a fluent-API builder with which you can create an <a href="StreamSource.html" title="interface in com.hazelcast.jet.pipeline">unbounded stream source</a> for a Jet pipeline.</div>
</td>
</tr>
<tr class="alt-color" id="i2">
<td class="col-first"><code>static &lt;C&gt;&nbsp;<a href="SourceBuilder.TimestampedStream.html" title="class in com.hazelcast.jet.pipeline">SourceBuilder.TimestampedStream</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="#timestampedStream(java.lang.String,com.hazelcast.function.FunctionEx)">timestampedStream</a></span>&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;name,
<a href="../../function/FunctionEx.html" title="interface in com.hazelcast.function">FunctionEx</a>&lt;? super <a href="../core/Processor.Context.html" title="interface in com.hazelcast.jet.core">Processor.Context</a>,&#8203;? extends C&gt;&nbsp;createFn)</code></th>
<td class="col-last">
<div class="block">Returns a fluent-API builder with which you can create an <a href="StreamSource.html" title="interface in com.hazelcast.jet.pipeline">unbounded stream source</a> for a Jet pipeline.</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="inherited-list">
<h3 id="methods.inherited.from.class.java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method.detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="batch(java.lang.String,com.hazelcast.function.FunctionEx)">
<h3>batch</h3>
<div class="member-signature"><span class="annotations"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html" title="class or interface in javax.annotation" class="external-link">@Nonnull</a>
</span><span class="modifiers">public static</span>&nbsp;<span class="type-parameters">&lt;C&gt;</span>&nbsp;<span class="return-type"><a href="SourceBuilder.Batch.html" title="class in com.hazelcast.jet.pipeline">SourceBuilder.Batch</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</span>&nbsp;<span class="member-name">batch</span>&#8203;(<span class="parameters"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html" title="class or interface in javax.annotation" class="external-link">@Nonnull</a>
<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;name,
<a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html" title="class or interface in javax.annotation" class="external-link">@Nonnull</a>
<a href="../../function/FunctionEx.html" title="interface in com.hazelcast.function">FunctionEx</a>&lt;? super <a href="../core/Processor.Context.html" title="interface in com.hazelcast.jet.core">Processor.Context</a>,&#8203;? extends C&gt;&nbsp;createFn)</span></div>
<div class="block">Returns a fluent-API builder with which you can create a <a href="BatchSource.html" title="interface in com.hazelcast.jet.pipeline">batch source</a> for a Jet pipeline. The source will use
 <a href="../core/Processor.html#isCooperative()">non-cooperative</a> processors.
 <p>
 Each parallel processor that drives your source has its private instance
 of a <i>context object</i> it got from your <code>createFn</code>. To get
 the data items to emit to the pipeline, the processor repeatedly calls
 your <code>fillBufferFn</code> with the context object and a buffer object.
 <p>
 Your function should add some items to the buffer, ideally those it has
 ready without having to block. A hundred items at a time is enough to
 eliminate any per-call overheads within Jet. If it doesn't have any
 items ready, it may also return without adding anything. In any case the
 function should not take more than a second or so to complete, otherwise
 you risk interfering with Jet's coordination mechanisms and getting bad
 performance.
 <p>
 Once it has emitted all the data, <code>fillBufferFn</code> must call <a href="SourceBuilder.SourceBuffer.html#close()"><code>buffer.close()</code></a>. This signals Jet to not call <code>
 fillBufferFn</code> again and at some later point it will call the <code>
 destroyFn</code> with the context object.
 <p>
 Unless you call <a href="SourceBuilder.Batch.html#distributed(int)"><code>builder.distributed()</code></a>,
 Jet will create just a single processor that should emit all the data.
 If you do call it, make sure your distributed source takes care of
 splitting the data between processors. Your <code>createFn</code> should
 consult <a href="../core/ProcessorMetaSupplier.Context.html#totalParallelism()"><code>processorContext.totalParallelism()</code></a>
 and <a href="../core/Processor.Context.html#globalProcessorIndex()"><code>processorContext.globalProcessorIndex()</code></a>.
 Jet calls it exactly once with each <code>globalProcessorIndex</code> from 0
 to <code>totalParallelism - 1</code> and each of the resulting context
 objects must emit its distinct slice of the total source data.
 <p>
 Here's an example that builds a simple, non-distributed source that
 reads the lines from a single text file. Since you can't control on
 which member of the Jet cluster the source's processor will run, the
 file should be available on all members. The source emits one line per
 <code>fillBufferFn</code> call.
 <pre><code>
 BatchSource&lt;String&gt; fileSource = SourceBuilder
         .batch("file-source", processorContext -&gt;
             new BufferedReader(new FileReader("input.txt")))
         .&lt;String&gt;fillBufferFn((in, buf) -&gt; {
             String line = in.readLine();
             if (line != null) {
                 buf.add(line);
             } else {
                 buf.close();
             }
         })
         .destroyFn(BufferedReader::close)
         .build();
 Pipeline p = Pipeline.create();
 BatchStage&lt;String&gt; srcStage = p.readFrom(fileSource);
 </code></pre></div>
<dl class="notes">
<dt>Type Parameters:</dt>
<dd><code>C</code> - type of the context object</dd>
<dt>Parameters:</dt>
<dd><code>name</code> - a descriptive name for the source (for diagnostic purposes)</dd>
<dd><code>createFn</code> - a function that creates the source's context object. It
                 must be stateless.</dd>
<dt>Since:</dt>
<dd>3.0</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="stream(java.lang.String,com.hazelcast.function.FunctionEx)">
<h3>stream</h3>
<div class="member-signature"><span class="annotations"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html" title="class or interface in javax.annotation" class="external-link">@Nonnull</a>
</span><span class="modifiers">public static</span>&nbsp;<span class="type-parameters">&lt;C&gt;</span>&nbsp;<span class="return-type"><a href="SourceBuilder.Stream.html" title="class in com.hazelcast.jet.pipeline">SourceBuilder.Stream</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</span>&nbsp;<span class="member-name">stream</span>&#8203;(<span class="parameters"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html" title="class or interface in javax.annotation" class="external-link">@Nonnull</a>
<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;name,
<a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html" title="class or interface in javax.annotation" class="external-link">@Nonnull</a>
<a href="../../function/FunctionEx.html" title="interface in com.hazelcast.function">FunctionEx</a>&lt;? super <a href="../core/Processor.Context.html" title="interface in com.hazelcast.jet.core">Processor.Context</a>,&#8203;? extends C&gt;&nbsp;createFn)</span></div>
<div class="block">Returns a fluent-API builder with which you can create an <a href="StreamSource.html" title="interface in com.hazelcast.jet.pipeline">unbounded stream source</a> for a Jet pipeline. The source will
 use <a href="../core/Processor.html#isCooperative()">non-cooperative</a> processors.
 <p>
 Each parallel processor that drives your source has its private instance
 of a <i>context object</i> it got from your <code>createFn</code>. To get
 the data items to emit to the pipeline, the processor repeatedly calls
 your <code>fillBufferFn</code> with the state object and a buffer object.
 <p>
 Your function should add some items to the buffer, ideally those it has
 ready without having to block. A hundred items at a time is enough to
 eliminate any per-call overheads within Jet. If it doesn't have any
 items ready, it may also return without adding anything. In any case the
 function should not take more than a second or so to complete, otherwise
 you risk interfering with Jet's coordination mechanisms and getting bad
 performance.
 <p>
 Unless you call <a href="SourceBuilder.Stream.html#distributed(int)"><code>builder.distributed()</code></a>,
 Jet will create just a single processor that should emit all the data.
 If you do call it, make sure your distributed source takes care of
 splitting the data between processors. Your <code>createFn</code> should
 consult <a href="../core/ProcessorMetaSupplier.Context.html#totalParallelism()"><code>processorContext.totalParallelism()</code></a>
 and <a href="../core/Processor.Context.html#globalProcessorIndex()"><code>processorContext.globalProcessorIndex()</code></a>.
 Jet calls it exactly once with each <code>globalProcessorIndex</code> from 0
 to <code>totalParallelism - 1</code> and each of the resulting context objects
 must emit its distinct slice of the total source data.
 <p>
 Here's an example that builds a simple, non-distributed source that
 polls a URL and emits all the lines it gets in the response:
 <pre><code>
 StreamSource&lt;String&gt; socketSource = SourceBuilder
     .stream("http-source", processorContext -&gt; HttpClients.createDefault())
     .&lt;String&gt;fillBufferFn((httpc, buf) -&gt; {
         new BufferedReader(new InputStreamReader(
             httpc.execute(new HttpGet("localhost:8008"))
                  .getEntity().getContent()))
             .lines()
             .forEach(buf::add);
     })
     .destroyFn(Closeable::close)
     .build();
 Pipeline p = Pipeline.create();
 StreamStage&lt;String&gt; srcStage = p.readFrom(socketSource);
 </code></pre></div>
<dl class="notes">
<dt>Type Parameters:</dt>
<dd><code>C</code> - type of the context object</dd>
<dt>Parameters:</dt>
<dd><code>name</code> - a descriptive name for the source (for diagnostic purposes)</dd>
<dd><code>createFn</code> - a function that creates the source's context object. It
                 must be stateless.</dd>
<dt>Since:</dt>
<dd>3.0</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="timestampedStream(java.lang.String,com.hazelcast.function.FunctionEx)">
<h3>timestampedStream</h3>
<div class="member-signature"><span class="annotations"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html" title="class or interface in javax.annotation" class="external-link">@Nonnull</a>
</span><span class="modifiers">public static</span>&nbsp;<span class="type-parameters">&lt;C&gt;</span>
<span class="return-type"><a href="SourceBuilder.TimestampedStream.html" title="class in com.hazelcast.jet.pipeline">SourceBuilder.TimestampedStream</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</span>&nbsp;<span class="member-name">timestampedStream</span>&#8203;(<span class="parameters"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html" title="class or interface in javax.annotation" class="external-link">@Nonnull</a>
<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;name,
<a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html" title="class or interface in javax.annotation" class="external-link">@Nonnull</a>
<a href="../../function/FunctionEx.html" title="interface in com.hazelcast.function">FunctionEx</a>&lt;? super <a href="../core/Processor.Context.html" title="interface in com.hazelcast.jet.core">Processor.Context</a>,&#8203;? extends C&gt;&nbsp;createFn)</span></div>
<div class="block">Returns a fluent-API builder with which you can create an <a href="StreamSource.html" title="interface in com.hazelcast.jet.pipeline">unbounded stream source</a> for a Jet pipeline. It will use
 <a href="../core/Processor.html#isCooperative()">non-cooperative</a> processors.
 <p>
 When emitting an item, the source can explicitly assign a timestamp to
 it. You can tell a Jet pipeline to use those timestamps by calling
 <a href="StreamSourceStage.html#withNativeTimestamps(long)"><code>sourceStage.withNativeTimestamps()</code></a>.
 <p>
 Each parallel processor that drives your source has its private instance
 of a <i>context object</i> it gets from the given <code>createFn</code>. To get
 the data items to emit to the pipeline, the processor repeatedly calls
 your <code>fillBufferFn</code> with the context object and a buffer object. The
 buffer's <a href="SourceBuilder.TimestampedSourceBuffer.html#add(T,long)"><code>add()</code></a> method
 takes two arguments: the item and the timestamp in milliseconds.
 <p>
 Your function should add some items to the buffer, ideally those it has
 ready without having to block. A hundred items at a time is enough to
 eliminate any per-call overheads within Jet. If it doesn't have any
 items ready, it may also return without adding anything. In any case the
 function should not take more than a second or so to complete, otherwise
 you risk interfering with Jet's coordination mechanisms and getting bad
 performance.
 <p>
 Unless you call <a href="SourceBuilder.TimestampedStream.html#distributed(int)"><code>builder.distributed()</code></a>, Jet will create just a single processor that
 should emit all the data. If you do call it, make sure your distributed
 source takes care of splitting the data between processors. Your <code>
 createFn</code> should consult <a href="../core/ProcessorMetaSupplier.Context.html#totalParallelism()"><code>procContext.totalParallelism()</code></a> and <a href="../core/Processor.Context.html#globalProcessorIndex()"><code>procContext.globalProcessorIndex()</code></a>. Jet calls it exactly once with each
 <code>globalProcessorIndex</code> from 0 to <code>totalParallelism - 1</code> and
 each of the resulting context objects must emit its distinct slice of the
 total source data.
 <p>
 Here's an example that builds a simple, non-distributed source that
 polls a URL and emits all the lines it gets in the response,
 interpreting the first 9 characters as the timestamp.
 <pre><code>
 StreamSource&lt;String&gt; socketSource = SourceBuilder
     .timestampedStream("http-source",
         processorContext -&gt; HttpClients.createDefault())
     .&lt;String&gt;fillBufferFn((httpc, buf) -&gt; {
         new BufferedReader(new InputStreamReader(
             httpc.execute(new HttpGet("localhost:8008"))
                  .getEntity().getContent()))
             .lines()
             .forEach(line -&gt; {
                 long timestamp = Long.valueOf(line.substring(0, 9));
                 buf.add(line.substring(9), timestamp);
             });
     })
     .destroyFn(Closeable::close)
     .build();
 Pipeline p = Pipeline.create();
 StreamStage&lt;String&gt; srcStage = p.readFrom(socketSource)
         .withNativeTimestamps(SECONDS.toMillis(5));
 </code></pre>
 <p>
 <strong>NOTE:</strong> if the data source you're adapting to Jet is
 partitioned, you may run into issues with event skew between partitions
 assigned to a given parallel processor. The timestamp you get from one
 partition may be significantly behind the timestamp you already got from
 another one. If the skew is more than the allowed lag and you have
 <a href="StreamSourceStage.html#withNativeTimestamps(long)">configured
 native timestamps</a>, you risk that the events will be late. Use a
 <a href="Sources.html#streamFromProcessorWithWatermarks(java.lang.String,boolean,com.hazelcast.function.FunctionEx)">custom processor</a>
 if you need to coalesce watermarks from multiple partitions.</div>
<dl class="notes">
<dt>Type Parameters:</dt>
<dd><code>C</code> - type of the context object</dd>
<dt>Parameters:</dt>
<dd><code>name</code> - a descriptive name for the source (for diagnostic purposes)</dd>
<dd><code>createFn</code> - a function that creates the source's context object. It
     must be stateless.</dd>
<dt>Since:</dt>
<dd>3.0</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottom-nav" id="navbar.bottom">
<div class="skip-nav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar.bottom.firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/SourceBuilder.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
</div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<span class="skip-nav" id="skip.navbar.bottom">
<!--   -->
</span></nav>
<p class="legal-copy"><small>Copyright &#169; 2021 <a href="http://www.hazelcast.com/">Hazelcast, Inc.</a>. All rights reserved.</small></p>
</footer>
</div>
</div>
</body>
</html>
